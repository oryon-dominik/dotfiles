system: write pytest tests for this code, don't use class based tests, always just use fixtures and module based pytest tests
